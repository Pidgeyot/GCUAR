<!DOCTYPE html>
<!--
GCU AR Tour
Made by Paige Mabbitt
September 2nd, 2022
-->
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/x-icon" href="lopespatt.png">
    <link rel="stylesheet" href="main.css">
    <script type='text/javascript' src='js/overlay.js'></script>
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
    <script src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js'></script>
    <title>GCU AR Tour</title>
</head>

<body style='margin : 0px; overflow: hidden;'>

    <div id="debug">AR</div>
    <div class="arjs-loader">
        <!--Make this a cute lopes loading animation-->
        <div>Loading, please wait...</div>
    </div>

    <!--Using AR.js tutorial: Displays video using image tracking-->
    <script>

        //this section makes the video play once the marker is found\

         //register the function to videohandler and initialize the function        
            AFRAME.registerComponent('videohandler', {
                init: function playvideo() {
                    //set marker to this.element
                    var marker = this.el;
                    //get the src of the a-video (classed as content)
                    var tag = marker.querySelector(".content").getAttribute('src');
                    //this.vid is equal to the element with the id of var tag
                    this.vid = document.querySelector(tag);

                    //add listener event to the marker: video is played when its found
                    marker.addEventListener('markerFound', function () {
                        this.vid.play();
                    }.bind(this));

                    //add listener event to the marker: video is stopped and reset when its lost
                    marker.addEventListener('markerLost', function () {
                        this.vid.pause();
                        this.vid.currentTime = 0;
                    }.bind(this));
                }
            });
       //load script on window load
        window.addEventListener("load", playvideo(), false);
        
    </script>

    <a-scene vr-mode-ui="enabled: false;"
             renderer='antialias: true; alpha: true; precision: medium;'
             embedded arjs='trackingMethod: best; sourceType: webcam; debugUIEnabled: false;'>

        <!--Declare assets here: differentiated by ID-->
        <a-assets>
            <!--Use a canvas to solve 404 issue?? Reference Stemkoski/AR-Exapmles -->
            <video src="https://player.vimeo.com/external/427115247.hd.mp4?s=568deebe927fe2ac1adc35cb876d65632663a380&profile_id=174" preload="auto" id="vid1" response-type="arraybuffer" loop webkit-playsinline playsinline crossorigin="anonymous">
            </video>

            <video src="https://player.vimeo.com/external/427115322.hd.mp4?s=94c25ae525c46f97e670386175b6aee0ecc03f8f&profile_id=174" preload="auto" id="vid2" response-type="arraybuffer" loop webkit-playsinline playsinline crossorigin="anonymous">
            </video>                                                                                                                                                                                                           
                                                                                                                                                                                                                               
            <video src="https://player.vimeo.com/external/385493799.hd.mp4?s=b3227481a20c30bb82c92123a7843c330f6c8dc4&profile_id=174" preload="auto" id="vid3" response-type="arraybuffer" loop webkit-playsinline playsinline crossorigin="anonymous">
            </video>                                                                                                                                                                                                           
                                                                                                                                                                                                                               
            <video src="https://player.vimeo.com/external/427115300.sd.mp4?s=e238034d38e23a5193176d101f60703e0633ce6e&profile_id=165" preload="auto" id="vid4" response-type="arraybuffer" loop webkit-playsinline playsinline crossorigin="anonymous">
            </video>

        </a-assets>

        <!--Set up pattern and corresponding content here: Use video ID for identification-->
        <!--Markers are best when they have different identafiable features to create detection
            ex: hiro: too little color
                lopes: good
                logo: good color and identifiable feature
                shirt: good, but must be up close for recognition
                imagetest: good tracking with many features, but has a hard time deciding where to put the video
                -->
        <a-nft videohandler
               type='nft' url='assets/3D_Printer'
               smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5" crossorigin="anonymous">
            <a-video src="#vid1"
                     class="content"
                     position='1200 1200 -100'
                     rotation='90 0 180'
                     width='300'
                     height='175'>
            </a-video>
        </a-nft>

        <a-nft videohandler
               type='nft' url='assets/lopespatt'
               smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5" crossorigin="anonymous">
            <a-video src="#vid2"
                     class="content"
                     position='200 200 -100'
                     rotation='90 0 180'
                     width='300'
                     height='175'>
            </a-video>
        </a-nft>

        <a-nft videohandler
               type='nft' url='assets/logo'
               smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5" crossorigin="anonymous">
            <a-video src="#vid3"
                     class="content"
                     position='200 200 -100'
                     rotation='90 0 180'
                     width='300'
                     height='175'>
            </a-video>
        </a-nft>

        <a-nft videohandler
               type='nft' url='assets/imagetest'
               smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5" crossorigin="anonymous">
            <a-video src="#vid4"
                     class="content"
                     position='1000 1000 -100'
                     rotation='90 0 180'
                     width='300'
                     height='175'>
            </a-video>
        </a-nft>

        <a-nft type="nft"
               url="assets/shirt"
               smooth="true"
               smoothCount="10"
               smoothTolerance=".01"
               smoothThreshold="5"
               crossorigin="anonymous">
            
            <a-entity gltf-model="antelope/antelope.gltf"
                      scale="500 500 500"
                      position="1000 1500 100">
                <!--"Paula the Antelope" (https://skfb.ly/6B9pO) by Diana Varro is licensed under Creative Commons Attribution (http://creativecommons.org/licenses/by/4.0/).-->
            </a-entity>
        </a-nft>

        <a-entity camera></a-entity>
    </a-scene>

    <!-- Overlay pulled from W3Schools https://www.w3schools.com/howto/howto_css_overlay.asp -->
        <!-- The overlay-->
        <div id="nav" class="overlay">

            <!-- Overlay content -->
            <nav class="overlay-content">
                <a href="tutorial.html">How It Works</a>
                <a href="checklist.html">Checklist</a>
                <a href="https://www.gcu.edu/">GCU School Site</a>
            </nav>

            <!-- Button to close the overlay navigation -->
            <button type="button" href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</button>

        </div>

        <footer>
            <!-- Button to open the overlay navigation -->
            <button type="button" onclick="openNav()" id="ar-open">&#9776;</button>
        </footer>

</body>
</html>